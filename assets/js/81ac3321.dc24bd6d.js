"use strict";(self.webpackChunkswiftui_realm_app=self.webpackChunkswiftui_realm_app||[]).push([[6262],{4137:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>h});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),c=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),p=c(a),u=n,h=p["".concat(l,".").concat(u)]||p[u]||m[u]||i;return a?r.createElement(h,s(s({ref:t},d),{},{components:a})):r.createElement(h,s({ref:t},d))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,s=new Array(i);s[0]=u;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[p]="string"==typeof e?e:n,s[1]=o;for(var c=2;c<i;c++)s[c]=a[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},7355:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var r=a(7462),n=(a(7294),a(4137));const i={},s="Changing the Schema",o={unversionedId:"migrating-schema/changing-schema",id:"migrating-schema/changing-schema",title:"Changing the Schema",description:"Adding a new field",source:"@site/docs/12-migrating-schema/1-changing-schema.mdx",sourceDirName:"12-migrating-schema",slug:"/migrating-schema/changing-schema",permalink:"/swiftui-realm-app-workshop/docs/migrating-schema/changing-schema",draft:!1,editUrl:"https://github.com/mongodb-developer/swiftui-realm-app-workshop/blob/main/docs/12-migrating-schema/1-changing-schema.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Migrating the Schema",permalink:"/swiftui-realm-app-workshop/docs/category/migrating-the-schema"},next:{title:"Bypassing the Migration",permalink:"/swiftui-realm-app-workshop/docs/migrating-schema/bypassing-migration"}},l={},c=[{value:"Adding a new field",id:"adding-a-new-field",level:2},{value:"Errors at runtime",id:"errors-at-runtime",level:2}],d={toc:c},p="wrapper";function m(e){let{components:t,...a}=e;return(0,n.kt)(p,(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"changing-the-schema"},"Changing the Schema"),(0,n.kt)("h2",{id:"adding-a-new-field"},"Adding a new field"),(0,n.kt)("p",null,"We'll add a new field to our ",(0,n.kt)("inlineCode",{parentName:"p"},"Days")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"Habits")," classes. This will be the user that created this piece of data (although right now as this is a local Realm Database we don't have any users around, but you can check the next workshop that uses Atlas Device Sync to store this data in MongoDB Atlas)"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-swift",metastring:"title='/Model/Habits.swift'",title:"'/Model/Habits.swift'"},'import RealmSwift\n\nclass Habits: Object {\n    @Persisted(primaryKey: true) var _id: ObjectId\n\n    @Persisted var habits = RealmSwift.List<Habit>()\n\n    // user that created this list of Habits\n    @Persisted var ownerId = ""\n}\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-swift",metastring:"title='/Model/Days.swift'",title:"'/Model/Days.swift'"},'import Foundation\nimport RealmSwift\n\nclass Days: Object, ObjectKeyIdentifiable {\n    @Persisted(primaryKey: true) var _id: ObjectId\n\n    @Persisted var days = RealmSwift.List<Day>()\n\n    // user that created this list of Habits\n    @Persisted var ownerId = ""\n}\n')),(0,n.kt)("h2",{id:"errors-at-runtime"},"Errors at runtime"),(0,n.kt)("p",null,"If we run our app now, we'll see it crashing on startup. Reading the error logs we see:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'Error Domain=io.realm Code=10 "Migration is required due to the following errors:\n')),(0,n.kt)("p",null,"This means that Realm stopped the app because we made one change to the schema of our classes, but we haven't told Realm what to do with the data that already exist in the database. We're adding a new field, should Realm add that field to all existing objects in the database? Has this been an error?"))}m.isMDXComponent=!0}}]);